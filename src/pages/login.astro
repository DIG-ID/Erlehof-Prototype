---
import "../scripts/auth.js";
import "../styles/global.css";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";

import { checkIfLoggedIn } from "../scripts/auth.js";

// Redirect if user is already logged in
await checkIfLoggedIn();
---

<form id="login-form" class="max-w-md mx-auto p-6 bg-white rounded-xl shadow-md space-y-6">
  <h2 class="text-2xl font-bold text-center text-gray-800">Login</h2>

  <!-- Identifier (Email or Username) -->
  <div class="space-y-2">
    <Label htmlFor="identifier" className="text-lg text-gray-700">Email or Username</Label>
    <Input
      id="identifier"
      name="identifier"
      type="text"
      required
      placeholder="Enter your email or username"
      className="w-full p-3 border rounded-md focus:ring-2 focus:ring-indigo-500"
    />
  </div>

  <!-- Password Input -->
  <div class="space-y-2">
    <Label htmlFor="password" className="text-lg text-gray-700">Password</Label>
    <Input
      id="password"
      name="password"
      type="password"
      required
      placeholder="Enter your password"
      className="w-full p-3 border rounded-md focus:ring-2 focus:ring-indigo-500"
    />
  </div>

  <!-- Submit Button -->
  <div class="text-center">
    <Button
      type="submit"
      className="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition"
    >
      Login
    </Button>
  </div>

  <p class="text-center text-sm text-gray-500">
    Don't have an account? 
    <a href="/register" class="text-blue-500 hover:underline">Register</a>
  </p>
</form>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    import("../scripts/auth.js").then(({ loginUser }) => {
      const form = document.getElementById("login-form");
      form?.addEventListener("submit", loginUser);
    });
  });
</script>
